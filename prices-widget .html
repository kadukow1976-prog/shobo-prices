<!doctype html><html lang="ru"><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Прайс с поиском</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#fff}
  .wrap{max-width:1000px;margin:0 auto;padding:16px}
  .panel{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:0 0 10px}
  .panel input{padding:8px 10px;border:1px solid #ddd;border-radius:10px}
  .panel button{padding:8px 12px;border:1px solid #333;border-radius:10px;background:#fff;cursor:pointer}
  .stats{margin-left:auto;font-size:12px;color:#666}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px;border-bottom:1px solid #eee;vertical-align:top}
  th{border-bottom:1px solid #ddd;text-align:left;cursor:pointer;user-select:none}
  td:last-child,th:last-child{text-align:right;white-space:nowrap}
  mark{background:#fff2a8}
</style>

<div class="wrap">
  <div class="panel">
    <input id="q" placeholder="Поиск по услуге/описанию" style="min-width:240px">
    <input id="minp" type="number" placeholder="от ₽" style="width:110px">
    <input id="maxp" type="number" placeholder="до ₽" style="width:110px">
    <button id="apply">Фильтр</button>
    <button id="reset">Сброс</button>
    <div class="stats" id="stats"></div>
  </div>

  <table id="tbl">
    <thead><tr>
      <th data-k="cat">Категория</th>
      <th data-k="name">Услуга</th>
      <th data-k="desc">Описание</th>
      <th data-k="price">Цена, от</th>
    </tr></thead>
    <tbody></tbody>
  </table>
</div>

<script>
const DATA = [
  {cat:"Смартфоны",name:"Замена экрана (LCD/OLED)",desc:"Полная замена модуля",price:1500},
  {cat:"Смартфоны",name:"Замена сенсорного стекла",desc:"Только если доступно отдельно",price:1200},
  {cat:"Смартфоны",name:"Замена аккумулятора",desc:"Оригинальный или аналог по модели",price:1000},
  {cat:"Смартфоны",name:"Замена разъёма зарядки",desc:"Пайка USB-разъёма или модуля",price:1000},
  {cat:"Смартфоны",name:"Замена микрофона/динамика",desc:"Плохой звук / не слышно",price:1000},
  {cat:"Смартфоны",name:"Замена камеры",desc:"Задняя или фронтальная",price:1000},
  {cat:"Смартфоны",name:"Замена кнопок",desc:"Питание / громкость / home",price:1000},
  {cat:"Смартфоны",name:"Ремонт платы (пайка)",desc:"При обрыве цепей / замыканиях",price:2500},
  {cat:"Смартфоны",name:"Восстановление после воды",desc:"Чистка, сушка, проверка",price:2500},
  {cat:"Смартфоны",name:"Замена слухового динамика",desc:"Проблемы со звуком при разговоре",price:1000},
  {cat:"Смартфоны",name:"Замена полифонического динамика",desc:"Не воспроизводится звук уведомлений/звонков",price:1000},
  {cat:"Смартфоны",name:"Замена микрофона",desc:"Не работает запись/голосовой ввод",price:1000}
];

const st={rows:DATA.slice(),view:[],sort:{k:'price',dir:1},q:'',min:null,max:null};
const esc=s=>String(s??'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[c]));
const hi=(t,q)=>!q?esc(t):esc(t).replace(new RegExp(q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),'gi'),m=>`<mark>${m}</mark>`);

function apply(){
  const q=(qEl.value||'').trim(); const min=Number(minEl.value); const max=Number(maxEl.value);
  st.q=q; st.min=Number.isFinite(min)?min:null; st.max=Number.isFinite(max)?max:null;
  st.view=st.rows.filter(x=>{
    const hit=!q||(x.cat+' '+x.name+' '+x.desc).toLowerCase().includes(q.toLowerCase());
    const gte=st.min==null||x.price>=st.min;
    const lte=st.max==null||x.price<=st.max;
    return hit&&gte&&lte;
  });
  sortAndRender();
}
function resetAll(){ qEl.value='';minEl.value='';maxEl.value='';st.q='';st.min=null;st.max=null;st.view=st.rows.slice();st.sort={k:'price',dir:1};render(); }
function sortAndRender(){
  const {k,dir}=st.sort;
  st.view.sort((a,b)=>k==='price'?(a.price-b.price)*dir:String(a[k]).localeCompare(String(b[k]),'ru')*dir);
  render();
}
function render(){
  const q=st.q;
  tb.innerHTML = st.view.map(x=>`
    <tr>
      <td>${hi(x.cat,q)}</td>
      <td>${hi(x.name,q)}</td>
      <td>${hi(x.desc,q)}</td>
      <td>${x.price.toLocaleString('ru-RU')}</td>
    </tr>`).join('') || `<tr><td colspan="4">Ничего не найдено</td></tr>`;
  stats.textContent=\`Найдено: \${st.view.length} из \${st.rows.length}\`;
}

const tb=document.querySelector('#tbl tbody'),stats=document.getElementById('stats'),
      qEl=document.getElementById('q'),minEl=document.getElementById('minp'),maxEl=document.getElementById('maxp');
document.getElementById('apply').onclick=apply;
document.getElementById('reset').onclick=resetAll;
document.querySelectorAll('#tbl thead th').forEach(th=>th.onclick=()=>{const k=th.dataset.k;if(!k)return;st.sort=st.sort.k===k?{k,dir:-st.sort.dir}:{k,dir:1};sortAndRender()});
st.view=st.rows.slice(); render();
</script>
