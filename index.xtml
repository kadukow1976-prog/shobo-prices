<!doctype html><html lang="ru"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Поиск по ценам — shobo</title>
<style>
  :root{--bd:#e5e7eb;--txt:#111827;--mut:#6b7280;--hl:#fff2a8}
  *{box-sizing:border-box}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--txt);margin:0;background:#fff}
  .wrap{max-width:1100px;margin:0 auto;padding:16px}
  h1{font-size:20px;margin:0 0 12px}
  .panel{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:0 0 12px}
  .panel input{padding:10px 12px;border:1px solid var(--bd);border-radius:12px}
  .panel button{padding:10px 14px;border:1px solid #111;border-radius:12px;background:#fff;cursor:pointer}
  .stats{margin-left:auto;font-size:12px;color:var(--mut)}
  .table-wrap{overflow:auto;border:1px solid var(--bd);border-radius:12px}
  table{width:100%;border-collapse:collapse;min-width:720px}
  th,td{padding:10px 12px;border-bottom:1px solid var(--bd);vertical-align:top}
  thead th{background:#f9fafb;text-align:left;user-select:none;cursor:pointer;position:sticky;top:0}
  td:last-child,th:last-child{text-align:right;white-space:nowrap}
  tr:nth-child(even) td{background:#fcfcfc}
  mark{background:var(--hl)}
  .note{font-size:12px;color:var(--mut);margin-top:8px}
  @media (max-width:640px){
    .panel{gap:6px}
    .panel input{flex:1 1 140px}
    .stats{width:100%;margin:6px 0 0}
  }
</style>
</head>
<body>
<div class="wrap">
  <h1>Поиск по ценам</h1>
  <div class="panel" role="search">
    <input id="q" placeholder="Поиск по категории/услуге/описанию" aria-label="Поиск">
    <input id="minp" type="number" inputmode="numeric" placeholder="от ₽" aria-label="Минимальная цена" style="width:130px">
    <input id="maxp" type="number" inputmode="numeric" placeholder="до ₽" aria-label="Максимальная цена" style="width:130px">
    <button id="apply" type="button">Фильтр</button>
    <button id="reset" type="button">Сброс</button>
    <div class="stats" id="stats" aria-live="polite"></div>
  </div>

  <div class="table-wrap">
    <table id="tbl">
      <thead><tr>
        <th data-k="cat"   title="Щёлкните для сортировки">Категория</th>
        <th data-k="name"  title="Щёлкните для сортировки">Услуга</th>
        <th data-k="desc"  title="Щёлкните для сортировки">Описание</th>
        <th data-k="price" title="Щёлкните для сортировки">Цена, от</th>
      </tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="note">Подсказка: кликайте по заголовкам таблицы, чтобы сортировать; в поиске работает подсветка совпадений.</div>
</div>

<script>
/* -------- ДАННЫЕ --------
   Реальные услуги можно править/добавлять здесь.
   Для "от X ₽" указывайте только число X (без пробелов/₽). Для неточной цены можно ставить 0 — выведется «—».
*/
const DATA = [
  // Смартфоны
  {cat:"Смартфоны",name:"Замена экрана (LCD/OLED)",desc:"Полная замена модуля",price:1500},
  {cat:"Смартфоны",name:"Замена сенсорного стекла",desc:"Только если доступно отдельное стекло",price:1200},
  {cat:"Смартфоны",name:"Замена аккумулятора",desc:"Оригинал/аналог по модели",price:1000},
  {cat:"Смартфоны",name:"Замена разъёма зарядки",desc:"Пайка USB-разъёма или модуля",price:1000},
  {cat:"Смартфоны",name:"Замена микрофона/динамика",desc:"Плохой звук / не слышно",price:1000},
  {cat:"Смартфоны",name:"Замена камеры",desc:"Задняя или фронтальная",price:1000},
  {cat:"Смартфоны",name:"Замена кнопок",desc:"Питание / громкость / home",price:1000},
  {cat:"Смартфоны",name:"Ремонт платы (пайка)",desc:"Обрыв цепей, замыкания",price:2500},
  {cat:"Смартфоны",name:"Восстановление после воды",desc:"Чистка, сушка, проверка",price:2500},
  {cat:"Смартфоны",name:"Замена слухового динамика",desc:"Проблемы со звуком при разговоре",price:1000},
  {cat:"Смартфоны",name:"Замена полифонического динамика",desc:"Нет звука уведомлений/звонков",price:1000},
  {cat:"Смартфоны",name:"Замена микрофона",desc:"Не работает запись/голосовой ввод",price:1000},
  // Разблокировка
  {cat:"Разблокировка",name:"Сброс аккаунта Google (FRP)",desc:"Удаление FRP",price:1500},
  {cat:"Разблокировка",name:"Сброс графического ключа",desc:"Без потери данных, если возможно",price:3500},
  {cat:"Разблокировка",name:"Сброс пароля/ПИН-кода",desc:"ADB/Recovery/софт",price:1500},
  // Прошивка
  {cat:"Прошивка",name:"Полная установка прошивки",desc:"Оригинальная/кастомная",price:1500},
  {cat:"Прошивка",name:"Обновление прошивки",desc:"До последней версии",price:1500},
  {cat:"Прошивка",name:"Понижение версии (downgrade)",desc:"Откат",price:2000},
  // Ноутбуки
  {cat:"Ноутбуки",name:"Чистка и замена термопасты",desc:"Система охлаждения",price:2000},
  {cat:"Ноутбуки",name:"Замена матрицы",desc:"LED/IPS, с разбором",price:2500},
  {cat:"Ноутбуки",name:"Установка Windows",desc:"С драйверами",price:1500},
  // Общие
  {cat:"Общее",name:"Диагностика устройства",desc:"Полная проверка",price:500},
];

const state={rows:DATA.slice(),view:[],sort:{k:'price',dir:1},q:'',min:null,max:null};

const esc=s=>String(s??'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[c]));
const hi=(t,q)=>!q?esc(t):esc(t).replace(new RegExp(q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),'gi'),m=>`<mark>${m}</mark>`);

// Безопасно читаем числа из полей (пусто → null)
function readNum(el){ const v=el.value.trim(); if(v==='') return null; const n=Number(v.replace(',', '.')); return Number.isFinite(n)?n:null; }

function apply(){
  const q=(qEl.value||'').trim().toLowerCase();
  state.q=q; state.min=readNum(minEl); state.max=readNum(maxEl);
  state.view=state.rows.filter(x=>{
    const text=(x.cat+' '+x.name+' '+x.desc).toLowerCase();
    const p=Number(x.price)||0;
    const hit=!q || text.includes(q);
    const gte=state.min==null || p>=state.min;
    const lte=state.max==null || p<=state.max;
    return hit && gte && lte;
  });
  sortAndRender();
}

function resetAll(){
  qEl.value=''; minEl.value=''; maxEl.value='';
  state.q=''; state.min=null; state.max=null;
  state.view=state.rows.slice(); state.sort={k:'price',dir:1};
  render();
}

function sortAndRender(){
  const {k,dir}=state.sort;
  state.view.sort((a,b)=>{
    if(k==='price') return ((Number(a.price)||0)-(Number(b.price)||0))*dir;
    return String(a[k]).localeCompare(String(b[k]),'ru')*dir;
  });
  render();
}

function render(){
  const q=state.q;
  tb.innerHTML = state.view.map(x=>`
    <tr>
      <td>${hi(x.cat,q)}</td>
      <td>${hi(x.name,q)}</td>
      <td>${hi(x.desc,q)}</td>
      <td>${(Number(x.price)||0) ? Number(x.price).toLocaleString('ru-RU') : '—'}</td>
    </tr>`).join('') || `<tr><td colspan="4">Ничего не найдено</td></tr>`;
  stats.textContent = `Найдено: ${state.view.length} из ${state.rows.length}`;
}

const tb=document.querySelector('#tbl tbody'),
      stats=document.getElementById('stats'),
      qEl=document.getElementById('q'),
      minEl=document.getElementById('minp'),
      maxEl=document.getElementById('maxp');

document.getElementById('apply').addEventListener('click', apply);
document.getElementById('reset').addEventListener('click', resetAll);
[qEl,minEl,maxEl].forEach(el=>el.addEventListener('keydown',e=>{ if(e.key==='Enter') apply(); }));

document.querySelectorAll('#tbl thead th').forEach(th=>{
  th.addEventListener('click',()=>{
    const k=th.dataset.k; if(!k) return;
    state.sort = state.sort.k===k ? {k,dir:-state.sort.dir} : {k,dir:1};
    sortAndRender();
  });
});

// Первая отрисовка
state.view=state.rows.slice(); render();
</script>
</body></html>
